
________Option Explicit____Sub test()________    Dim nlastrow As Integer, i As Integer________    Dim dfvalue As String, dkvalue As String, tvalue As String, layertypevalue As String____    Dim Ttemp_value As String____    ____    Dim Dalltext_n As Object  '数字无单位的项____    Dim Dalltext_bool As Object  'bool项____    Dim Dalltext_mil As Object  '单位mil的项____    Dim Dalltext_ghz As Object  '单位ghz的项____    Dim elem_temp____    Set Dalltext_n = CreateObject("Scripting.Dictionary")____    Set Dalltext_bool = CreateObject("Scripting.Dictionary")____    Set Dalltext_mil = CreateObject("Scripting.Dictionary")____    Set Dalltext_ghz = CreateObject("Scripting.Dictionary")________    Dim outfile As String  '用于输出文本文件________    '读取叠层____    nlastrow = Range("E200").End(xlUp).Row    '以df列为准, df列最后一个有值的行的行号____    ____    'df____    dfvalue = "t_PP_df = ["____    ____    If Trim(CStr(Range("E8").Value)) <> "" Then____        Ttemp_value = Trim(CStr(Range("E8").Value))____        If Ttemp_value Like ".*" Then____            dfvalue = dfvalue & Chr(34) & "0" & Ttemp_value & Chr(34)____        Else____            dfvalue = dfvalue & Chr(34) & Ttemp_value & Chr(34)____        End If____    Else____        MsgBox "df列信息有误"____    End If____    ____    For i = 9 To nlastrow____        If Trim(CStr(Range("E" & i).Value)) <> "" Then____            Ttemp_value = Trim(CStr(Range("E" & i).Value))____            If Ttemp_value Like ".*" Then____                dfvalue = dfvalue & ", " & Chr(34) & "0" & Ttemp_value & Chr(34)____            Else____                dfvalue = dfvalue & ", " & Chr(34) & Ttemp_value & Chr(34)____            End If____        Else____            MsgBox "df列信息有误"____        End If____    Next____    ____    dfvalue = dfvalue & "]"____    ____    'dk____    dkvalue = "t_PP_dk = ["____    ____    If Trim(CStr(Range("D8").Value)) <> "" Then____        Ttemp_value = Trim(CStr(Range("D8").Value))____        If Ttemp_value Like ".*" Then____            dkvalue = dkvalue & Chr(34) & "0" & Ttemp_value & Chr(34)____        Else____            dkvalue = dkvalue & Chr(34) & Ttemp_value & Chr(34)____        End If____    Else____        MsgBox "dk列信息有误"____    End If____    ____    For i = 9 To nlastrow____        If Trim(CStr(Range("D" & i).Value)) <> "" Then____            Ttemp_value = Trim(CStr(Range("D" & i).Value))____            If Ttemp_value Like ".*" Then____                dkvalue = dkvalue & ", " & Chr(34) & "0" & Ttemp_value & Chr(34)____            Else____                dkvalue = dkvalue & ", " & Chr(34) & Ttemp_value & Chr(34)____            End If____        Else____            MsgBox "dk列信息有误"____        End If____    Next____    ____    dkvalue = dkvalue & "]"____    ____    'thick____    tvalue = "t_Tpcb_list = ["____    ____    If Trim(CStr(Range("C8").Value)) <> "" Then____        Ttemp_value = Trim(CStr(Range("C8").Value))____        If Ttemp_value Like ".*" Then____            tvalue = tvalue & Chr(34) & "0" & Ttemp_value & "mil" & Chr(34)____        Else____            tvalue = tvalue & Chr(34) & Ttemp_value & "mil" & Chr(34)____        End If____    Else____        MsgBox "thick列信息有误"____    End If____    ____    For i = 9 To nlastrow____        If Trim(CStr(Range("C" & i).Value)) <> "" Then____            Ttemp_value = Trim(CStr(Range("C" & i).Value))____            If Ttemp_value Like ".*" Then____                tvalue = tvalue & ", " & Chr(34) & "0" & Ttemp_value & "mil" & Chr(34)____            Else____                tvalue = tvalue & ", " & Chr(34) & Ttemp_value & "mil" & Chr(34)____            End If____        Else____            MsgBox "thick列信息有误"____        End If____    Next____    ____    tvalue = tvalue & "]"____    ____    'layer type____    layertypevalue = "t_Layertype = ["____    ____    If Trim(CStr(Range("B8").Value)) <> "" Then____        Ttemp_value = Trim(CStr(Range("B8").Value))____        If Ttemp_value Like ".*" Then____            layertypevalue = layertypevalue & Chr(34) & "0" & Ttemp_value & Chr(34)____        Else____            layertypevalue = layertypevalue & Chr(34) & Ttemp_value & Chr(34)____        End If____    Else____        MsgBox "layer type列信息有误"____    End If____    ____    For i = 9 To nlastrow____        If Trim(CStr(Range("B" & i).Value)) <> "" Then____            Ttemp_value = Trim(CStr(Range("B" & i).Value))____            If Ttemp_value Like ".*" Then____                layertypevalue = layertypevalue & ", " & Chr(34) & "0" & Ttemp_value & Chr(34)____            Else____                layertypevalue = layertypevalue & ", " & Chr(34) & Ttemp_value & Chr(34)____            End If____        Else____            MsgBox "layer type列信息有误"____        End If____    Next____    ____    layertypevalue = layertypevalue & "]"____    ____    '其他数据 使用字典 Dalltext____    Dalltext_mil.Add "t_Lsize_x", "K14"____    Dalltext_mil.Add "t_Lsize_y", "K14"____    Dalltext_mil.Add "t_D_pad", "H11"____    Dalltext_mil.Add "t_D_drill", "H12"____    Dalltext_mil.Add "t_Tplating", "H14"____    Dalltext_mil.Add "t_Space_via2via", "H15"____    Dalltext_mil.Add "t_D_antipad", "H13"____    Dalltext_mil.Add "t_Space_via2gndvia", "H16"____    Dalltext_bool.Add "backdrillornot", "H19"____    Dalltext_n.Add "t_backdrill_top", "H20"____    Dalltext_n.Add "t_backdrill_bottom", "H21"____    Dalltext_mil.Add "t_backdrill_stub", "H22"____    Dalltext_mil.Add "t_D_backdrill", "H23"____    Dalltext_n.Add "t_startlayer", "H7"____    Dalltext_n.Add "t_endlayer", "H8"____    Dalltext_mil.Add "t_W_trace", "K7"____    Dalltext_mil.Add "t_S_trace", "K8"____    Dalltext_n.Add "MsPortXsize", "K9"____    Dalltext_n.Add "MsPortYsize", "K10"____    Dalltext_n.Add "SlPortXsize", "K11"____    Dalltext_mil.Add "AirBoxHSizeaboveTOP", "K16"____    Dalltext_ghz.Add "Fsolution", "K19"____    Dalltext_ghz.Add "Fmax", "K20"____    ____    For Each elem_temp In Dalltext_mil.Keys()____        If Trim(CStr(Range(Dalltext_mil.Item(elem_temp)).Value)) <> "" Then____            Ttemp_value = Trim(CStr(Range(Dalltext_mil.Item(elem_temp)).Value))____            If Ttemp_value Like ".*" Then____                Dalltext_mil.Item(elem_temp) = elem_temp & "=" & Chr(34) & "0" & Ttemp_value & "mil" & Chr(34)____            Else____                Dalltext_mil.Item(elem_temp) = elem_temp & "=" & Chr(34) & Ttemp_value & "mil" & Chr(34)____            End If____        Else____            MsgBox elem_temp & "信息有误, 位置" & Dalltext_mil(elem_temp)____        End If____    Next____    ____    For Each elem_temp In Dalltext_ghz.Keys()____        If Trim(CStr(Range(Dalltext_ghz.Item(elem_temp)).Value)) <> "" Then____            Ttemp_value = Trim(CStr(Range(Dalltext_ghz.Item(elem_temp)).Value))____            If Ttemp_value Like ".*" Then____                Dalltext_ghz.Item(elem_temp) = elem_temp & "=" & Chr(34) & "0" & Ttemp_value & "GHz" & Chr(34)____            Else____                Dalltext_ghz.Item(elem_temp) = elem_temp & "=" & Chr(34) & Ttemp_value & "GHz" & Chr(34)____            End If____        Else____            MsgBox elem_temp & "信息有误, 位置" & Dalltext_ghz(elem_temp)____        End If____    Next____    ____    For Each elem_temp In Dalltext_n.Keys()____        If Trim(CStr(Range(Dalltext_n.Item(elem_temp)).Value)) <> "" Then____            Ttemp_value = Trim(CStr(Range(Dalltext_n.Item(elem_temp)).Value))____            If Ttemp_value Like ".*" Then____                Dalltext_n.Item(elem_temp) = elem_temp & "=" & Chr(34) & "0" & Ttemp_value & Chr(34)____            Else____                Dalltext_n.Item(elem_temp) = elem_temp & "=" & Chr(34) & Ttemp_value & Chr(34)____            End If____        Else____            MsgBox elem_temp & "信息有误, 位置" & Dalltext_n(elem_temp)____        End If____    Next____    ____    For Each elem_temp In Dalltext_bool.Keys()____        If Trim(CStr(Range(Dalltext_bool.Item(elem_temp)).Value)) <> "" Then____            Ttemp_value = Trim(CStr(Range(Dalltext_bool.Item(elem_temp)).Value))____            If Ttemp_value Like "*是*" Then____                Dalltext_bool.Item(elem_temp) = elem_temp & "=" & "True"____            Else____                Dalltext_bool.Item(elem_temp) = elem_temp & "=" & "False"____            End If____        Else____            MsgBox elem_temp & "信息有误, 位置" & Dalltext_bool(elem_temp)____        End If____    Next____    ____    '输出____    '定义文本文件的名称____    outfile = ThisWorkbook.Path & "\diffviainput.py"____    '判断是否存在同名文本文件，存在先行删除____    If Dir(outfile) <> "" Then Kill outfile____    '将当前的数据读入数组____    '使用print语句将数组中所有数据写入文本文件____    Open outfile For Output As #1____    '输出信息____    Print #1, layertypevalue____    Print #1, tvalue____    Print #1, dkvalue____    Print #1, dfvalue________    For Each elem_temp In Dalltext_bool.Keys()____        Print #1, Dalltext_bool.Item(elem_temp)____    Next____    ____    For Each elem_temp In Dalltext_mil.Keys()____        Print #1, Dalltext_mil.Item(elem_temp)____    Next____    ____    For Each elem_temp In Dalltext_ghz.Keys()____        Print #1, Dalltext_ghz.Item(elem_temp)____    Next____    ____    For Each elem_temp In Dalltext_n.Keys()____        Print #1, Dalltext_n.Item(elem_temp)____    Next________    '关闭文本文件____    Close #1________    '运行 Environ ("Windir")____    'Dim WSH, wExec, sCmd As String, Result As String____    'Set WSH = CreateObject("WScript.Shell")____    'Set wExec = WSH.Exec("ping 127.0.0.1")____    'Result = wExec.StdOut.ReadAll____    'MsgBox Result____    'Set wExec = Nothing____    'Set WSH = Nothing________End Sub________
