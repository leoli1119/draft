000000


Option ExplicitSub test()
    Dim nlastrow As Integer, i As Integer
    Dim dfvalue As String, dkvalue As String, tvalue As String, layertypevalue As String    Dim Ttemp_value As String        Dim Dalltext_n As Object  '数字无单位的项    Dim Dalltext_bool As Object  'bool项    Dim Dalltext_mil As Object  '单位mil的项    Dim Dalltext_ghz As Object  '单位ghz的项    Dim elem_temp    Set Dalltext_n = CreateObject("Scripting.Dictionary")    Set Dalltext_bool = CreateObject("Scripting.Dictionary")    Set Dalltext_mil = CreateObject("Scripting.Dictionary")    Set Dalltext_ghz = CreateObject("Scripting.Dictionary")
    Dim outfile As String  '用于输出文本文件
    '读取叠层    nlastrow = Range("E200").End(xlUp).Row    '以df列为准, df列最后一个有值的行的行号        'df    dfvalue = "t_PP_df = ["        If Trim(CStr(Range("E8").Value)) <> "" Then        Ttemp_value = Trim(CStr(Range("E8").Value))        If Ttemp_value Like ".*" Then            dfvalue = dfvalue & Chr(34) & "0" & Ttemp_value & Chr(34)        Else            dfvalue = dfvalue & Chr(34) & Ttemp_value & Chr(34)        End If    Else        MsgBox "df列信息有误"    End If        For i = 9 To nlastrow        If Trim(CStr(Range("E" & i).Value)) <> "" Then            Ttemp_value = Trim(CStr(Range("E" & i).Value))            If Ttemp_value Like ".*" Then                dfvalue = dfvalue & ", " & Chr(34) & "0" & Ttemp_value & Chr(34)            Else                dfvalue = dfvalue & ", " & Chr(34) & Ttemp_value & Chr(34)            End If        Else            MsgBox "df列信息有误"        End If    Next        dfvalue = dfvalue & "]"        'dk    dkvalue = "t_PP_dk = ["        If Trim(CStr(Range("D8").Value)) <> "" Then        Ttemp_value = Trim(CStr(Range("D8").Value))        If Ttemp_value Like ".*" Then            dkvalue = dkvalue & Chr(34) & "0" & Ttemp_value & Chr(34)        Else            dkvalue = dkvalue & Chr(34) & Ttemp_value & Chr(34)        End If    Else        MsgBox "dk列信息有误"    End If        For i = 9 To nlastrow        If Trim(CStr(Range("D" & i).Value)) <> "" Then            Ttemp_value = Trim(CStr(Range("D" & i).Value))            If Ttemp_value Like ".*" Then                dkvalue = dkvalue & ", " & Chr(34) & "0" & Ttemp_value & Chr(34)            Else                dkvalue = dkvalue & ", " & Chr(34) & Ttemp_value & Chr(34)            End If        Else            MsgBox "dk列信息有误"        End If    Next        dkvalue = dkvalue & "]"        'thick    tvalue = "t_Tpcb_list = ["        If Trim(CStr(Range("C8").Value)) <> "" Then        Ttemp_value = Trim(CStr(Range("C8").Value))        If Ttemp_value Like ".*" Then            tvalue = tvalue & Chr(34) & "0" & Ttemp_value & "mil" & Chr(34)        Else            tvalue = tvalue & Chr(34) & Ttemp_value & "mil" & Chr(34)        End If    Else        MsgBox "thick列信息有误"    End If        For i = 9 To nlastrow        If Trim(CStr(Range("C" & i).Value)) <> "" Then            Ttemp_value = Trim(CStr(Range("C" & i).Value))            If Ttemp_value Like ".*" Then                tvalue = tvalue & ", " & Chr(34) & "0" & Ttemp_value & "mil" & Chr(34)            Else                tvalue = tvalue & ", " & Chr(34) & Ttemp_value & "mil" & Chr(34)            End If        Else            MsgBox "thick列信息有误"        End If    Next        tvalue = tvalue & "]"        'layer type    layertypevalue = "t_Layertype = ["        If Trim(CStr(Range("B8").Value)) <> "" Then        Ttemp_value = Trim(CStr(Range("B8").Value))        If Ttemp_value Like ".*" Then            layertypevalue = layertypevalue & Chr(34) & "0" & Ttemp_value & Chr(34)        Else            layertypevalue = layertypevalue & Chr(34) & Ttemp_value & Chr(34)        End If    Else        MsgBox "layer type列信息有误"    End If        For i = 9 To nlastrow        If Trim(CStr(Range("B" & i).Value)) <> "" Then            Ttemp_value = Trim(CStr(Range("B" & i).Value))            If Ttemp_value Like ".*" Then                layertypevalue = layertypevalue & ", " & Chr(34) & "0" & Ttemp_value & Chr(34)            Else                layertypevalue = layertypevalue & ", " & Chr(34) & Ttemp_value & Chr(34)            End If        Else            MsgBox "layer type列信息有误"        End If    Next        layertypevalue = layertypevalue & "]"        '其他数据 使用字典 Dalltext    Dalltext_mil.Add "t_Lsize_x", "K14"    Dalltext_mil.Add "t_Lsize_y", "K14"    Dalltext_mil.Add "t_D_pad", "H11"    Dalltext_mil.Add "t_D_drill", "H12"    Dalltext_mil.Add "t_Tplating", "H14"    Dalltext_mil.Add "t_Space_via2via", "H15"    Dalltext_mil.Add "t_D_antipad", "H13"    Dalltext_mil.Add "t_Space_via2gndvia", "H16"    Dalltext_bool.Add "backdrillornot", "H19"    Dalltext_n.Add "t_backdrill_top", "H20"    Dalltext_n.Add "t_backdrill_bottom", "H21"    Dalltext_mil.Add "t_backdrill_stub", "H22"    Dalltext_mil.Add "t_D_backdrill", "H23"    Dalltext_n.Add "t_startlayer", "H7"    Dalltext_n.Add "t_endlayer", "H8"    Dalltext_mil.Add "t_W_trace", "K7"    Dalltext_mil.Add "t_S_trace", "K8"    Dalltext_n.Add "MsPortXsize", "K9"    Dalltext_n.Add "MsPortYsize", "K10"    Dalltext_n.Add "SlPortXsize", "K11"    Dalltext_mil.Add "AirBoxHSizeaboveTOP", "K16"    Dalltext_ghz.Add "Fsolution", "K19"    Dalltext_ghz.Add "Fmax", "K20"        For Each elem_temp In Dalltext_mil.Keys()        If Trim(CStr(Range(Dalltext_mil.Item(elem_temp)).Value)) <> "" Then            Ttemp_value = Trim(CStr(Range(Dalltext_mil.Item(elem_temp)).Value))            If Ttemp_value Like ".*" Then                Dalltext_mil.Item(elem_temp) = elem_temp & "=" & Chr(34) & "0" & Ttemp_value & "mil" & Chr(34)            Else                Dalltext_mil.Item(elem_temp) = elem_temp & "=" & Chr(34) & Ttemp_value & "mil" & Chr(34)            End If        Else            MsgBox elem_temp & "信息有误, 位置" & Dalltext_mil(elem_temp)        End If    Next        For Each elem_temp In Dalltext_ghz.Keys()        If Trim(CStr(Range(Dalltext_ghz.Item(elem_temp)).Value)) <> "" Then            Ttemp_value = Trim(CStr(Range(Dalltext_ghz.Item(elem_temp)).Value))            If Ttemp_value Like ".*" Then                Dalltext_ghz.Item(elem_temp) = elem_temp & "=" & Chr(34) & "0" & Ttemp_value & "GHz" & Chr(34)            Else                Dalltext_ghz.Item(elem_temp) = elem_temp & "=" & Chr(34) & Ttemp_value & "GHz" & Chr(34)            End If        Else            MsgBox elem_temp & "信息有误, 位置" & Dalltext_ghz(elem_temp)        End If    Next        For Each elem_temp In Dalltext_n.Keys()        If Trim(CStr(Range(Dalltext_n.Item(elem_temp)).Value)) <> "" Then            Ttemp_value = Trim(CStr(Range(Dalltext_n.Item(elem_temp)).Value))            If Ttemp_value Like ".*" Then                Dalltext_n.Item(elem_temp) = elem_temp & "=" & Chr(34) & "0" & Ttemp_value & Chr(34)            Else                Dalltext_n.Item(elem_temp) = elem_temp & "=" & Chr(34) & Ttemp_value & Chr(34)            End If        Else            MsgBox elem_temp & "信息有误, 位置" & Dalltext_n(elem_temp)        End If    Next        For Each elem_temp In Dalltext_bool.Keys()        If Trim(CStr(Range(Dalltext_bool.Item(elem_temp)).Value)) <> "" Then            Ttemp_value = Trim(CStr(Range(Dalltext_bool.Item(elem_temp)).Value))            If Ttemp_value Like "*是*" Then                Dalltext_bool.Item(elem_temp) = elem_temp & "=" & "True"            Else                Dalltext_bool.Item(elem_temp) = elem_temp & "=" & "False"            End If        Else            MsgBox elem_temp & "信息有误, 位置" & Dalltext_bool(elem_temp)        End If    Next        '输出    '定义文本文件的名称    outfile = ThisWorkbook.Path & "\diffviainput.py"    '判断是否存在同名文本文件，存在先行删除    If Dir(outfile) <> "" Then Kill outfile    '将当前的数据读入数组    '使用print语句将数组中所有数据写入文本文件    Open outfile For Output As #1    '输出信息    Print #1, layertypevalue    Print #1, tvalue    Print #1, dkvalue    Print #1, dfvalue
    For Each elem_temp In Dalltext_bool.Keys()        Print #1, Dalltext_bool.Item(elem_temp)    Next        For Each elem_temp In Dalltext_mil.Keys()        Print #1, Dalltext_mil.Item(elem_temp)    Next        For Each elem_temp In Dalltext_ghz.Keys()        Print #1, Dalltext_ghz.Item(elem_temp)    Next        For Each elem_temp In Dalltext_n.Keys()        Print #1, Dalltext_n.Item(elem_temp)    Next
    '关闭文本文件    Close #1
    '运行 Environ ("Windir")    'Dim WSH, wExec, sCmd As String, Result As String    'Set WSH = CreateObject("WScript.Shell")    'Set wExec = WSH.Exec("ping 127.0.0.1")    'Result = wExec.StdOut.ReadAll    'MsgBox Result    'Set wExec = Nothing    'Set WSH = Nothing
End Sub



